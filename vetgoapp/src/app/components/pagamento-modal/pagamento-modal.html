<div class="modal-overlay" *ngIf="atendimentoAtual">

  <div class="modal-content">
    <div class="modal-header">
      <h3>Registrar Pagamento para o Atendimento #{{ atendimentoAtual.id }}</h3>

      <button [routerLink]="['/list-atendimento']">X</button>

    </div>
    <div class="modal-body">

      <form (ngSubmit)="salvarPagamento()">
        <h4>Procedimentos</h4>
        <div *ngFor="let item of procedimentos; let i = index" class="procedimento-item-flex-container">
          <div class="procedimento-inputs">
            <div class="form-group">
              <label for="descricao-{{i}}">Descrição do Procedimento #{{ i + 1 }}</label>
              <input type="text" id="descricao-{{i}}" [(ngModel)]="item.descricao" name="descricao-{{i}}" required>
            </div>
            <div class="form-group">
              <label for="valor-{{i}}">Valor (R$)</label>
              <input type="number" id="valor-{{i}}" [(ngModel)]="item.valor" name="valor-{{i}}"
                (input)="recalcularValores()" required>
            </div>
          </div>
          <div class="procedimento-botoes">
            <button type="button" class="remover-btn" *ngIf="procedimentos.length > 1" (click)="removerProcedimento(i)">
              <img src="assets/imagens/delete.svg" alt="Remover">
            </button>
            <button type="button" class="adicionar-btn-pequeno" (click)="adicionarProcedimento()"
              *ngIf="i === procedimentos.length - 1">
              <img src="assets/imagens/plus.svg" alt="Adicionar">
            </button>
          </div>
        </div>

        <hr>

        <div class="resumo-pagamento">
          <p><strong>Valor Total dos Procedimentos:</strong> {{ valorTotal | currency:'BRL' }}</p>
        </div>

        <div class="form-group">
          <label for="valorPago">Valor Pago</label>
          <input type="number" id="valorPago" [(ngModel)]="valorPago" name="valorPago" (input)="calcularSaldo()"
            required>
        </div>

        <div class="resumo-final">
          <p [ngClass]="{'pendente': saldoRestante > 0, 'pago': saldoRestante <= 0}">
            <strong>Saldo Restante:</strong> {{ saldoRestante | currency:'BRL' }}
          </p>
          <p class="status-pagamento">
            <strong>Status:</strong>
            <span *ngIf="saldoRestante > 0">Pendente</span>
            <span *ngIf="saldoRestante <= 0">Pago</span>
          </p>
        </div>

        <div class="modal-footer">
          <button type="submit" class="salvar-btn">Salvar Pagamento</button>
        </div>
      </form>

    </div>
  </div>

</div>