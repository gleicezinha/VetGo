<div class="form-container">
  <h2>Agende seu atendimento</h2>
  <form #formAtendimento="ngForm" (ngSubmit)="save()">

    <div class="form-group">
      <label for="responsavel">Responsável</label>
      <select id="responsavel"
              name="responsavel"
              [(ngModel)]="responsavelIdSelecionado"
              (ngModelChange)="onResponsavelChange($event)"
              [disabled]="!!route.snapshot.queryParamMap.get('responsavelId')"
              required>
        <option [ngValue]="undefined">Selecione um responsável</option>
        <option *ngFor="let resp of responsaveis" [value]="resp.id">
          {{ resp.usuario?.nomeUsuario }}
        </option>
      </select>
    </div>

    <div class="form-group" *ngIf="pacientesDoResponsavel.length > 0">
      <label for="paciente">Paciente (Pet)</label>
      <select id="paciente"
              name="paciente"
              [(ngModel)]="pacienteIdSelecionado"
              [disabled]="!!route.snapshot.queryParamMap.get('pacienteId')"
              required>
        <option [ngValue]="undefined">Selecione um pet</option>
        <option *ngFor="let pet of pacientesDoResponsavel" [value]="pet.id">
          {{ pet.nome }}
        </option>
      </select>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="profissional">Profissional</label>
        <select id="profissional" name="profissional" [(ngModel)]="profissionalIdSelecionado" required>
          <option [ngValue]="undefined">Selecione um profissional</option>
          <option *ngFor="let prof of profissionais" [value]="prof.id">{{ prof.usuario?.nomeUsuario }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="tipo">Tipo de Atendimento</label>
        <select id="tipo" name="tipo" [(ngModel)]="registroParcial.tipoDeAtendimento" required>
          <option *ngFor="let tipo of tiposDeAtendimento" [ngValue]="tipo">{{ tipo }}</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="data">Data do Atendimento</label>
        <input type="datetime-local" id="data" name="data" [(ngModel)]="registroParcial.dataHoraAtendimento" required>
      </div>
    </div>

    <div class="form-group">
      <label for="observacao">Observações</label>
      <textarea id="observacao" name="observacao" [(ngModel)]="registroParcial.observacao" rows="4"></textarea>
    </div>

    <div class="form-buttons">
      <button type="submit" [disabled]="formAtendimento.invalid" class="btn-salvar">Salvar</button>
      <button type="button" class="btn-cancelar" [routerLink]="['/list-cliente']">Cancelar</button>
    </div>
  </form>
</div>